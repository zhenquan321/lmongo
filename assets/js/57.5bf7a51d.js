(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{441:function(s,n,t){"use strict";t.r(n);var a=t(43),e=Object(a.a)({},function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"koa2-初体验"}},[s._v("Koa2 初体验")]),s._v(" "),t("p",[s._v("上一节讲了Node.js 的模块以及npm。想必大家都学会了如何安装以及使用Node 模块。这一节，我们一起来看看看Koa2")]),s._v(" "),t("h2",{attrs:{id:"hello-koa2"}},[s._v("Hello Koa2")]),s._v(" "),t("p",[s._v("新建一个文件夹hiKoa2，并进入该项目，执行"),t("code",[s._v("npm init")]),s._v(" 命令，根据提示输入，生成package.json 文件。你也可以直接使用"),t("code",[s._v("npm init -y")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新建文件夹并进入")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" hiKoa2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" hiKoa2\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# npm init -y 自动生成package.json")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" init -y\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("安装 Koa2")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" koa --save \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("新建 index.js，say hello")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" Koa "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'koa'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" app "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Koa")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\napp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" ctx "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  ctx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello World'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\napp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("在命令行输入 "),t("code",[s._v("node index.js")]),s._v(" 访问http://localhost:3000/ 页面将显示 hello, Hello World。恭喜，你已经成功跑起来了个Koa2服务。")]),s._v(" "),t("p",[s._v("之前写过一篇"),t("a",{attrs:{href:"https://github.com/liuxing/node-abc/tree/master/lesson9",target:"_blank",rel:"noopener noreferrer"}},[s._v("Koa2快速入门"),t("OutboundLink")],1),s._v(" 介绍了Koa2 路由、静态资源、模板引擎、请求数据的获取等。这儿就不再赘述，关于数据库的使用之后再补上")]),s._v(" "),t("h2",{attrs:{id:"使用supervisor-或者-nodemon"}},[s._v("使用"),t("a",{attrs:{href:"https://github.com/petruisfan/node-supervisor",target:"_blank",rel:"noopener noreferrer"}},[s._v("supervisor"),t("OutboundLink")],1),s._v(" 或者 "),t("a",{attrs:{href:"https://github.com/remy/nodemon",target:"_blank",rel:"noopener noreferrer"}},[s._v("nodemon"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("在第一节的时候我们说过"),t("a",{attrs:{href:"https://github.com/petruisfan/node-supervisor",target:"_blank",rel:"noopener noreferrer"}},[s._v("supervisor"),t("OutboundLink")],1),s._v("  和 "),t("a",{attrs:{href:"https://github.com/remy/nodemon",target:"_blank",rel:"noopener noreferrer"}},[s._v("nodemon"),t("OutboundLink")],1),s._v("，不知道你们有没有去自己了解。现在来看看如何使用。")]),s._v(" "),t("p",[s._v("安装使用supervisor")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 全局安装")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i -g supervisor\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行程序")]),s._v("\n$ supervisor index.js\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("现在更改index.js 文件试试，supervisor 会自动重启程序而不需要我们手动重启，supervisor 会监听当前目录下的js文件。nodemon使用方式基本一样，不过可配置性更高。")]),s._v(" "),t("h2",{attrs:{id:"调试node-js"}},[s._v("调试Node.js")]),s._v(" "),t("p",[t("strong",[s._v("使用VS Code 调试")])]),s._v(" "),t("p",[s._v("如果你是用VS Code这个宇宙最强编辑器，那很方便你可以直接使用其自带的调试工具。")]),s._v(" "),t("ol",[t("li",[s._v("单击左侧第 4 个 tab "),t("em",[s._v("(调试图标一个虫子那个图标)")])]),s._v(" "),t("li",[s._v("点击击代码第 5 行 "),t("code",[s._v("ctx.body = 'Hello World'")]),s._v(" 左侧空白处添加断点。")]),s._v(" "),t("li",[s._v("单击左上角 ”调试“ 的绿色三角按钮选着Node.js环境 开始调试。")]),s._v(" "),t("li",[s._v("点击左上角的终端图标打开调试控制台。")])]),s._v(" "),t("p",[s._v("现在在浏览器中打开 http://localhost:3000/  *(也可以直接切换到终端  "),t("code",[s._v("curl localhost:3000")]),s._v(")*就可以从VS Code 的调试栏查看详细信息了。")]),s._v(" "),t("p",[t("strong",[s._v("使用 Chrome DevTools")])]),s._v(" "),t("p",[s._v("曾经要想在Chrome DevTools中调试我们需要 "),t("a",{attrs:{href:"https://github.com/node-inspector/node-inspector",target:"_blank",rel:"noopener noreferrer"}},[s._v("node-inspector"),t("OutboundLink")],1),s._v(" 这个工具，node@6.3以后内置了一个调试器。")]),s._v(" "),t("p",[s._v("我们只需要运行一下命令，再访问 chrome://inspect  点击 Remote Target 下的 inspect，选择 Sources 找到源码即可打断点调试。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ node --inspect index.js\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])},[],!1,null,null,null);e.options.__file="2.1Koa2初体验.md";n.default=e.exports}}]);